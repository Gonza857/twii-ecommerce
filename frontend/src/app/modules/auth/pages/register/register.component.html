<main class="styledMain d-flex flex-column registration-container bg-principal">
  <p-card
    header="Registro de Usuario"
    subheader="Completa los siguientes campos para crear tu cuenta"
    class="col-12 col-sm-8 col-md-7 col-lg-4"
    styleClass="bg-secundario"
  >

    <div class="mb-3">
      <span class="text-white">¿Ya tienes una cuenta?</span>
      <a routerLink="/cuenta/login" class="ms-1 text-primary text-decoration-underline text-primario">Inicia sesión</a>
    </div>

    <form class="col-12 d-flex flex-column p-0" [formGroup]="form">

      <div class="row">
        <div class="field col">
          <label for="nombre">Nombre *</label>
          <input
            pInputText
            id="nombre"
            name="nombre"
            formControlName="nombre"
            placeholder="Ingresa tu nombre"
            class="col-4"
          />
        </div>

        <div class="field col">
          <label for="apellido">Apellido *</label>
          <input
            pInputText
            fluid
            id="apellido"
            name="apellido"
            formControlName="apellido"
            placeholder="Ingresa tu apellido"
            class="col-6"/>
        </div>
      </div>

      <div class="field">
        <label for="email">Email *</label>
        <input
          pInputText
          id="email"
          name="email"
          formControlName="email"
          type="email"
          placeholder="ejemplo@correo.com"
          class="w-full"/>
      </div>

      <div class="field">
        <label for="contrasena">Contraseña *</label>
        <input
          pInputText
          id="contrasena"
          name="contrasena"
          formControlName="contrasena"
          type="password"
          placeholder="Ingresa tu contraseña"
          class="w-full"/>
        @if (form.get("cContrasena")?.hasError("mismatch")) {
          <p class="text-danger">Las contraseñas deben ser iguales</p>
        }
        @if (form.get('contrasena')?.errors?.['minlength']) {
          <p class="text-danger">La contraseña debe tener al menos 6 carácteres.</p>
        }
      </div>

      <div class="field">
        <label for="contrasena">Confirmar Contraseña *</label>
        <input
          pInputText
          id="cContrasena"
          name="cContrasena"
          formControlName="cContrasena"
          type="password"
          placeholder="Ingresa tu contraseña"
          class="w-full"/>
        @if (form.get("cContrasena")?.hasError("mismatch")) {
          <p class="text-danger">Las contraseñas deben ser iguales</p>
        }
      </div>

      <div class="field">
        <label for="direccion">Dirección</label>
        <input
          pInputText
          id="direccion"
          name="direccion"
          formControlName="direccion"
          placeholder="Ingresa tu dirección (opcional)"
          class="w-full"/>
      </div>


      @if (mensajeError ?? false) {
        <div class="field">
          <p-message severity="error" class="col-12">{{ mensajeError }}</p-message>
        </div>
      }

      @if (exito) {
        <div class="field">
          <p-message severity="success" class="col-12">Registrado correctamante. Revisa tu bandeja de entrada y confirma
            tu cuenta.
          </p-message>
        </div>
      }

      <button
        type="submit"
        [disabled]="enviando || form.invalid"
        (click)="register()"
        class="btn-primario"
      >
        {{ !enviando ? 'Registrarme' : 'Registrando...' }}
      </button>


      <p class="text-center mt-3 text-sm text-secundario">
        Los campos marcados con * son obligatorios
      </p>

    </form>
  </p-card>
</main>
