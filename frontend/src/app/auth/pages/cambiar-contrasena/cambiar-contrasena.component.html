<main class="login-wrapper d-flex justify-content-center align-items-center vh-100 bg-dark">
  <p-card header="Cambiar contraseña" subheader="Introduce tu nueva contraseña" class="col-11 col-sm-8 col-md-5 col-lg-4 col-xl-3">

    <form class="col-12 d-flex flex-column gap-3 p-0" [formGroup]="form">
      <div class="form-group d-flex flex-column">
        <label for="contrasena">Nueva Contraseña</label>
        <p-password
          id="contrasena"
          fluid
          formControlName="contrasena"
          [feedback]="false"
          [toggleMask]="true"
        ></p-password>
        @if (form.get("contrasena")?.hasError("required") && form.get("contrasena")?.touched) {
          <p class="text-danger m-0">Este campo es requerido</p>
        }
        @if (form.get("contrasena")?.hasError("mismatch")) {
          <p class="text-danger m-0">Las contraseñas deben ser iguales</p>
        }
        @if (form.get('contrasena')?.errors?.['minlength']) {
          <p class="text-danger m-0">La contraseña debe tener al menos 6 caracteres.</p>
        }
      </div>

      <div class="form-group d-flex flex-column">
        <label for="cContrasena">Confirmar Contraseña</label>
        <p-password
          id="cContrasena"
          formControlName="cContrasena"
          [feedback]="false"
          [toggleMask]="true"
          fluid
        ></p-password>
        @if (form.get("cContrasena")?.hasError("mismatch")) {
          <p class="text-danger">Las contraseñas deben ser iguales</p>
        }
      </div>

      <input type="hidden" name="token" [value]="this.token "/>

      @if (exito) {
        <div class="alert alert-success text-center p-1 m-0" role="alert">
          Redirigiendo al inicio de sesión...
        </div>
      }

      @if (mensajeError ?? false) {
        <div class="field">
          <p-message severity="error" class="col-12">{{ mensajeError }}</p-message>
        </div>
      }

      <p-button
        type="submit"
        [label]="enviando ? 'Actualizando...' : 'Guardar Contraseña'"
        fluid
        [disabled]="enviando"
        [raised]="true"
        severity="info"
        [loading]="enviando"
        loadingIcon="pi pi-spinner pi-spin"
        (onClick)="enviar()"
      />
    </form>
  </p-card>
</main>
